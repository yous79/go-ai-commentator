# 囲碁AI解説システム 統合仕様書 (Gemini.md) - Rev. 40.0

## 0. モデル名称・認識に関する絶対規約
(省略)

### 0.4 実行プロセスにおける絶対遵守事項
- **承認の必須性**: 実装、リファクタリング、ファイル操作等の「盤面やコードへの変更」を伴う作業に着手する際は、案を提示した後、**必ずユーザーからの明示的な承認を得ること。**
- **独断実行の禁止**: 「進めてよいか」の確認と同時に実装（ツール呼び出し）を開始することは厳禁とする。必ずターンを分けてユーザーの返答を待つこと。

### 0.5 開発・検証プロセス [NEW]
- **自動検証モード**: `--verify` フラグによる主要機能（ロード、解析、解説生成）の一括自動テストを、大規模なリファクタリング後の標準的な動作確認手順とする。

## 4. 解析データ・パイプライン [REVISED]
- **DTO (Data Transfer Object)**: 
    - 解析データは生の辞書（dict）として持ち回らず、`AnalysisResult` および `MoveCandidate` オブジェクトを介して受け渡される。
    - プロパティベースのアクセスにより、タイポの防止と型安全性を保証する。

## 6. AI解説生成：事実先行・人格統合プロトコル [REVISED]
- **Persona Strategy Pattern**: 
    - 解説のトーン、使用テンプレート、重点指導項目は `Persona` オブジェクトにカプセル化される。
    - `TARGET_LEVEL` に応じて適切な人格（`BeginnerPersona`, `IntermediatePersona` 等）が動的に選択される。
    - 解説ロジック本体から特定のレベルに依存した条件分岐（if文）を排除し、拡張性を担保する。

(以下、第7条以降は継続)
