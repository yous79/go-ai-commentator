# 囲碁AI解説システム アイデア・ストック (IDEAS.md)

このファイルは、システムのさらなる進化のための改善案や新機能のアイデアを蓄積・管理するバックログです。

## 1. 視覚的・分析的強化 (Visual & Analytical)
- [ ] **地の勢力可視化 (Ownership Map)**: 盤上の黒地・白地の勢力圏を半透明で可視化し、大局観をサポート。
- [x] **勝率推移グラフの動的表示**: メインUIにmatplotlib等のグラフを埋め込み、形勢の波を一目で把握可能に。
- [ ] **石の強弱スコアリング**: Ownershipデータから「攻められている石」「安定した石」を定量化し、Geminiに事実として注入。

## 2. インタラクティブ・学習 (Interactive Learning)
- [ ] **座標ハイライト連携**: Geminiの解説文内の座標をクリックすると、盤上の該当位置が点滅・プレビュー。
- [ ] **検討モード勝率比較 (What-if)**: 検討手順を置いた瞬間に、元の局面との勝率差をリアルタイム表示。
- [ ] **AI推奨図の連番表示**: PVを表示する際、現在の検討モードの仕組みを流用して石に手順番号を振る。

## 3. レポート機能の高度化 (Advanced Reporting)
- [ ] **「今局の急所」自動選定**: 勝率低下と悪形検知が重なった手を、最重要学習ポイントとしてレポート最上部に配置。
- [ ] **グラフ付きPDF**: 勝率推移グラフを自動生成し、PDFレポートの冒頭に挿入。
- [ ] **HTMLレポート出力**: 画像をインライン表示したリッチなウェブ形式レポートの生成。

## 4. 知識ベース・アルゴリズム (Knowledge & Algorithms)
- [ ] **形状検知の拡充**: 「タケフ（竹節）」「一間トビ（効率的な連結）」「団子石（効率の悪い塊）」の追加。
- [ ] **自律的用語学習**: 未定義だがKataGoが重要視する形をGeminiが発見し、仮の名称で解説する仕組み。
- [x] **MCPリソース化**: 知識ベースを `knowledge://` スキーマ経由でフェッチ可能にし、コンテキスト窓を節約。（Rev 17.0で対応済）

## 5. アーキテクチャ・最適化 (Engineering)
- [x] **バッチ解析の並列化**: SGFロード時のバックグラウンド解析を複数スレッド化し、高速化。
- [ ] **セッション管理**: 複数の対局やクライアントからの同時接続を、より厳密に分離・管理。
- [ ] **ロギング統合**: 各プロセスのログを `src/utils/logger.py` で一元管理し、トレーサビリティを向上。

## 6. リファクタリング・堅牢化 (Refactoring & Robustness) - Rev 17.0+
- [ ] **知識アクセスの抽象化 (Knowledge Repository)**: `src/mcp_server.py` のファイル読み込みロジックを `KnowledgeRepository` クラスに分離し、他コンポーネントからも利用可能にする。
- [ ] **GUIの責務分離 (Observer/ViewModel)**: `app.py` からビジネスロジック（ファイル監視、API同期）を切り出し、Viewは描画のみに専念させる。
- [ ] **形状検知の単体テスト化 (Unit Testing)**: アスキーアート等を用いた盤面データを `detect()` 関数に渡すテストスイートを作成し、コマンド一発で論理検証可能にする。
- [ ] **APIクライアントの共通化**: 分散しているHTTPリクエスト処理を `src/api_client.py` に集約し、タイムアウトやリトライを一元管理する。

## 7. MCP高度化・リソース基盤 (Advanced MCP & Resources)
- [ ] **動的ゲームコンテキスト (`mcp://game/current/sgf`)**: 現在ロードされているSGFのメタデータや着手履歴を即座に返す動的リソースを実装。AIが「今何手目か」をゼロコストで把握。
- [ ] **リアルタイム解析進捗 (`mcp://analysis/status`)**: KataGoの解析完了率や発見された悪形の概要を返すリソース。AIがユーザーへの応答タイミングを判断する材料にする。
- [ ] **知識リソースの構造化 (JSON/Linked Data)**: 知識テキストを構造化し、`See also: mcp://...` のようなリンクを含めることで、AIが関連知識を芋づる式に参照可能にする。
- [ ] **プロンプトテンプレートのMCP化**: Pythonコード内のプロンプトをMCPの `Prompt` 機能へ移行。AIの性格（ペルソナ）や指導方針をコード変更なしで調整可能にする。
- [ ] **状況適応型インストラクション**: 序盤・中盤・終盤などの局面に応じて、MCPから注入する指示を動的に切り替える（大局観重視かヨセ重視か等）。

---
*最終更新: 2026-01-12 (Rev 17.0 Updated)*